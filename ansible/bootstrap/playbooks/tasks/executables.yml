- name: Create the OTClient .desktop file
  copy:
    dest: /home/{{ deploy_username }}/Desktop/client.desktop
    content: |
      [Desktop Entry]
      Version=1.0
      Name=client
      Comment=Launches OTClient
      Exec=/home/{{ deploy_username }}/otclient/otclient
      Icon=utilities-terminal
      Terminal=false
      Type=Application
      Categories=Utility;
    mode: '0755'
    owner: "{{ deploy_username  }}"
    group: "{{ deploy_username  }}"

- name: Ensure the .desktop file is executable
  file:
    path: /home/{{ deploy_username }}/Desktop/client.desktop
    mode: '0755'
    owner: "{{ deploy_username }}"
    group: "{{ deploy_username }}"

- name: Create the server .desktop file
  copy:
    dest: /home/{{ deploy_username }}/Desktop/server.desktop
    content: |
      [Desktop Entry]
      Version=1.0
      Name=server
      Comment=Launches server
      Exec=/home/{{ deploy_username }}/canary/docker/compose.sh
      Icon=utilities-terminal
      Terminal=false
      Type=Application
      Categories=Utility;
    mode: '0755'
    owner: "{{ deploy_username  }}"
    group: "{{ deploy_username  }}"

- name: Ensure the .desktop file is executable
  file:
    path: /home/{{ deploy_username }}/Desktop/server.desktop
    mode: '0755'
    owner: "{{ deploy_username }}"
    group: "{{ deploy_username }}"

# # gio: Setting attribute metadata::trusted not supported
# - name: Set metadata::trusted attribute for the client.desktop file
#   command: gio set /home/{{ deploy_username }}/Desktop/client.desktop metadata::trusted true

# # gio: Setting attribute metadata::trusted not supported
# - name: Set metadata::trusted attribute for the server.desktop file
#   command: gio set /home/{{ deploy_username }}/Desktop/server.desktop metadata::trusted true
